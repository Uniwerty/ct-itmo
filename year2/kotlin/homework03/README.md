
## Часть 1
 
Сделаем класс RedditClient.

Он будет скачивать объекты с соцсети [reddit](https://www.reddit.com)

В ней есть разные сообщества. В сообществах бывают публикации,
в публикациях - обсуждения.

Например, есть сообщество про [Kotlin][https://www.reddit.com/r/Kotlin/]

Или про [Python][https://www.reddit.com/r/Python/]

А вот[ публикация с обсуждением][https://www.reddit.com/r/Kotlin/comments/z02i23/what_is_dispatchersdefaults_maximum_number_of/]

### Задание 1

Мы хотим сделать метод 

```
suspend getTopic(name: String): TopicSnapshot
```

Он должен возвращать текущее состояние первой заглавной страницы топика.

Данные можно взять из json-версии ресурса.

Для Kotlin это будет (https://www.reddit.com/r/Kotlin/.json)

Нужно десериализовать серию json-структур и добраться до списка обсуждений.

А также до некоторых общих свойств топика.

Общие свойства топика, которые должны попасть в TopicSnapshot:

- время создания
- количество подписчиков онлайн
- ранг по размеру
- описание топика

Все, что видно в html-интерфейсе под "About community".

Также в TopicSnapshot должен попасть список краткой информации о доступных с заглавной
страницы обсуждениях:

- автор сообщения
- время публикации
- количество голосований за и против
- заголовок
- текст
- текст как html

Возможно, вам покажутся интересныеми какие-то еще поля.

Также TopicSnapshot должен содержать момент его получения и уникальный id в рамках топика.

Десериализацию делаем с помощью библиотеки [Jackson](https://github.com/FasterXML/jackson)

С ее помощью можно получить каскад map-ов, а можно получить структуры данных.

В данном задании получить структуры. И поскольку мы не собираемся их менять, то это должны быть
immutable-структуры.

Jackson по умолчанию требует set-методов и конструктор по умолчанию.
Как с этим побороться, можно почитать [здесь](https://hceris.com/painless-json-with-kotlin-and-jackson/)

Учебные материалы про Jackson общего плана: (https://www.baeldung.com/jackson), (https://habr.com/ru/company/otus/blog/687004/)


### Задание 2

По каждому сообщению можем открыть его страничку (точнее - json-версию)

Например, [такую][https://www.reddit.com/r/Kotlin/comments/z02i23/what_is_dispatchersdefaults_maximum_number_of/.json]

Или вот [еще](https://www.reddit.com/r/Kotlin/comments/z3qwxa/additional_monads_not_defined_in_arrow/.json),
где побольше комментариев


Мы хотим сделать метод

```
suspend getComments(title: String): CommentsSnapshot
```

Здесь нужно получить набор комментариев.

Комментарии имеют древовидную структуру произвольной вложенности.

Про каждый комментарий нужно узнать 

- время его публикации
- количество лайков и дизлайков
- текст комментария
- автор

CommentsSnapshot должен содержать момент его получения и список структур, описывающих каждый комментарий.

Также надо представить иерархию комментариев в "линеаризованной" форме.

 Каждый комментарий получает числовой id (уникальный в рамках дискуссии). И поле replyTo, в котором хранится id
комментария, на который отвечаем.

И еще заведем поле depth, в котором будем хранить глубину комментария в дереве ответов.


### Задание 3

Итак, мы можем узнать свежие обсуждения про Kotlin или Python, и пройтись и собрать комментарии по каждому.

(Кстати, если мы знаем, что их нет - то можно и не идти)

Надо теперь их сохранить.

Сохраним их в файле.

Тоже через корутины.

Для каждого топика сохраняем два файла. Один назовем <topic name>-<timestamp>-subjects.csv, 
другой - <comments>-<timestamp>-comments.csv

В один мы запишем данные списка тем из TopicSnapshot.

В другой - данные о комментариях.

Для их связи в первом для каждого обсуждения будет указан его id, а во втором будет
отдельное поле с его значением.

Запишем мы это все в csv-файлы с помощью своего мини-фреймворка для работы с csv.

За основу возьмем фрагменты кода, представленные на лекции. Я их пришлю отдельно.

Возможно, их надо будет доработать.


### Задание 4

Собрать общее приложение.

В командной строке передаем список интересующих тем, после чего собираем данные,
как сказано выше, пишем в CSV-файлы и сообщаем об успехе или неуспехе.


Пишем все к котлин-стиле. Никакой мутабельности без необходимости. 
Продумываем интерфейсы. Максимальная приватность всего.

В качестве корутинных библиотек предлагаются korio (http и файлы).
Или Ktor[CIO]. Именно CIO, ничто другое.

Если вам нравится что-то другое, спросите у меня, можно ли это использовать.

